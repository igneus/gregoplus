{% extends 'base.html' %}

{% block content %}
<h1>{% block title %}{{ score.incipit }}{% endblock %}</h1>

<div class="my-4">
  <a href="{% url 'scores:gabc' score.id %}" class="btn btn-primary">
    <i class="bi bi-download mx-1"></i>
    GABC
  </a>
  <a href="https://gregobase.selapa.net/chant.php?id={{ score.id }}" class="btn btn-secondary">
    <i class="bi bi-box-arrow-up-right mx-1"></i>
    GregoBase
  </a>
  {% if score.cantusid %}
  <a href="https://cantusindex.org/id/{{ score.cantusid }}" class="btn btn-secondary">
    <i class="bi bi-box-arrow-up-right mx-1"></i>
    CantusIndex
  </a>
  {% endif %}
</div>

<div class="container">
  <div class="row g-4 gx-5">
    <div class="col col-lg-4 order-lg-last">
      <img src="https://gregobase.selapa.net/chant_img.php?id={{ score.id }}" alt="{{ score.incipit }}">
    </div>
    <div class="col col-lg-8">
      <h2 class="h4">Version</h2>
      {{ score.version }}

      <h2 class="h4">Usage</h2>
      {% include 'scores/_office_part.html' %}

      <h2 class="h4">Tags</h2>
      {% if tags|length == 0 %}
      <p><em>No tags.</em></p>
      {% else %}
      <ul>
        {% for tag in tags %}
        <li><a href="{% url 'scores:tag_detail' tag.id %}">{{ tag }}</a></li>
        {% endfor %}
      </ul>
      {% endif %}

      <h2 class="h4">Sources</h2>
      {% if chant_sources|length == 0 %}
      <p><em>No sources.</em></p>
      {% else %}
      <ul>
        {% for cs in chant_sources %}
        <li>
          <a href="{% url 'scores:source_detail' cs.source.id %}">
            {% include 'scores/_source_citation.html' with source=cs.source %}
          </a>,
          p. {{ cs.page }}
        </li>
        {% endfor %}
      </ul>
      {% endif %}

      <h2 class="h4">GABC</h2>
      <pre class="text-wrap">{{ gabc.gabc_with_verses }}</pre>
      {% if gabc.has_additional_content %}
        <div class="alert alert-info">
          GregoBase data for this piece contain additional TeX typesetting information
          which is ignored by GregoPlus, as GregoPlus is interested
          exclusively in chant melodies.
          Please refer to GregoBase for these details.
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
